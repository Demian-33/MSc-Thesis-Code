x11(); print(g1)
# (4) Modelo probit-ordenado para estimación ====
## (4.1) Seleccionar datos ====
# 0: urbano, 1: rural
tmp <- tibble(ym, contexto=Xide$rururb)
tmp <- tmp %>% mutate(
ym_ord = case_when(
is.na(ym) ~ NA,
contexto==0 & ym < log(LPEI_urb) ~ 0,
contexto==1 & ym < log(LPEI_rur) ~ 0,
contexto==0 & ym > log(LPEI_urb) & ym < log(LPI_urb)  ~ 1,
contexto==1 & ym > log(LPEI_rur) & ym < log(LPI_rur)  ~ 1,
TRUE  ~ 2),
ym_bin = case_when(
ym_ord <= 1 ~ 1, # si carencias
is.na(ym_ord) ~ NA,
TRUE ~ 0)# no carencias
)
table(tmp$ym_ord)
# no invertir
# tmp$ym_ord <- ifelse(tmp$ym_ord == 0, 2, ifelse(tmp$ym_ord == 2, 0, 1))
set.seed(1)
datos <- get_obs(censo=F, y=tmp$ym_ord, prop=0.2)
datos <- get_obs(censo=T, y=tmp$ym_ord, prop=0.2)
datos$y_mis
datos$y_obs
## (4.2) Cargar el modelo con VB ====
load(r'(C:\Maestría_CP\Tesis\Documento-Tesis-SAOM\EntornosR\muestraVB-probit-ordenado-sesgado-estimacion.RData)')
muestra_vb <- muestra_probitordVB$summary(variables = c('rho', 'delta1', 'mu', 'b'), out_stan)
## (4.4) Cargar el modelo con HMC ====
load(r'(C:\Maestría_CP\Tesis\Documento-Tesis-SAOM\EntornosR\muestraHMC-probit-ordenado-sesgado-estimacion.RData)')
muestra_hmc <- muestra_probitordHMC$summary(variables = c('rho', 'delta1', 'mu', 'b'), c(out_stan, 'rhat'))
colnames(muestra_hmc) <- paste0(colnames(muestra_hmc), 2)
## (4.5) Tabla de estimaciones ====
parametros <- c(
paste0('$\\rho_{', 1:K, '}$'),
'$\\delta_{1}$',
paste0('$\\mu_{', 1:K, '}$')
)
pred_out <- tibble(parametros,
muestra_vb[1:length(parametros), c(2, 6, 7)],
muestra_hmc[1:length(parametros), c(2, 6, 7, 8)])
nombre <- file.path(fsep='\\', r'(C:\Maestría_CP\Tesis\Documento-Tesis-SAOM\Documento-Tesis\Figuras\c-vi\CDMX)',
'probit-ordenado-sesgado-tabla.txt')
writeLines(pred_out %>% kable(format = 'latex', escape = F), con = nombre)
tmp <- readLines(nombre)
tmp <- tmp[-c(1:5, length(tmp)-1, length(tmp))]
tmp[length(tmp)] <- str_split_1(tmp[length(tmp)], pattern = '\\\\\\\\')[1]
writeLines(tmp, nombre)
tmp
## (4.7) Porcentaje de personas ====
delta_vb <- c(0.0, unlist(muestra_vb[17, 2]))
delta_hmc <- c(0.0, unlist(muestra_hmc[17, 2]))
delta_vb
delta_hmc
out <- which(is.na(ym))
fitted_vb <- findInterval(apply(muestra_probitordVB$draws('z_all'), 2, mean), delta_vb)
fitted_hmc <- findInterval(apply(drop(muestra_probitordHMC$draws('z_all')), 2, mean), delta_hmc)
dftmp <- tibble(LPI_vb=ifelse(fitted_vb[out]==1, 1, 0),
LPI_hmc=ifelse(fitted_hmc[out]==1, 1, 0),
LPEI_vb=ifelse(fitted_vb[out]==0, 1, 0),
LPEI_hmc=ifelse(fitted_hmc[out]==0, 1, 0),
Ámbito=Xide$rururb[out],
Factor=Xide$factor[out],
Tamaño=Xide$tam_hog[out],
Alcaldia=muni[region][out])
#
dftmp2 <- dftmp %>%
group_by(Alcaldia) %>%
summarise(Total = sum(Factor*Tamaño),
Total_LPI_vb = sum(Factor*LPI_vb*Tamaño),
Total_LPI_hmc = sum(Factor*LPI_hmc*Tamaño),
Total_LPEI_vb = sum(Factor*LPEI_vb*Tamaño),
Total_LPEI_hmc = sum(Factor*LPEI_hmc*Tamaño),
Porcentaje_LPI_vb = 100*Total_LPI_vb/Total,
Porcentaje_LPEI_vb = 100*Total_LPEI_vb/Total,
Porcentaje_LPI_hmc = 100*Total_LPI_hmc/Total,
Porcentaje_LPEI_hmc = 100*Total_LPEI_hmc/Total)
dftmp2 %>% select(Total, starts_with('Porcentaje'))
sum(dftmp2$Total_LPI_vb) / sum(dftmp2$Total) # 25.7 %
sum(dftmp2$Total_LPI_hmc) / sum(dftmp2$Total) # 25.7 %
sum(dftmp2$Total_LPEI_vb) / sum(dftmp2$Total) # 25.7 %
sum(dftmp2$Total_LPEI_hmc) / sum(dftmp2$Total) # 25.7 %
## (4.7) Porcentaje de personas ====
delta_vb <- c(0.0, unlist(muestra_vb[17, 2]))
delta_hmc <- c(0.0, unlist(muestra_hmc[17, 2]))
out <- which(is.na(ym))
fitted_vb <- findInterval(apply(muestra_probitordVB$draws('z_all'), 2, mean), delta_vb)
fitted_hmc <- findInterval(apply(drop(muestra_probitordHMC$draws('z_all')), 2, mean), delta_hmc)
dftmp <- tibble(LPI_vb=ifelse(fitted_vb[out]==1, 1, 0),
LPI_hmc=ifelse(fitted_hmc[out]==1, 1, 0),
LPEI_vb=ifelse(fitted_vb[out]==0, 1, 0),
LPEI_hmc=ifelse(fitted_hmc[out]==0, 1, 0),
Ámbito=Xide$rururb[out],
Factor=Xide$factor[out],
Tamaño=Xide$tam_hog[out],
Alcaldia=muni[region][out])
#
dftmp2 <- dftmp %>%
group_by(Alcaldia) %>%
summarise(Total = sum(Factor*Tamaño),
Total_LPI_vb = sum(Factor*LPI_vb*Tamaño),
Total_LPI_hmc = sum(Factor*LPI_hmc*Tamaño),
Total_LPEI_vb = sum(Factor*LPEI_vb*Tamaño),
Total_LPEI_hmc = sum(Factor*LPEI_hmc*Tamaño),
Porcentaje_LPI_vb = 100*Total_LPI_vb/Total,
Porcentaje_LPEI_vb = 100*Total_LPEI_vb/Total,
Porcentaje_LPI_hmc = 100*Total_LPI_hmc/Total,
Porcentaje_LPEI_hmc = 100*Total_LPEI_hmc/Total)
dftmp2 %>% select(Total, starts_with('Porcentaje'))
sum(dftmp2$Total_LPI_vb) / sum(dftmp2$Total) # 25.7 %
sum(dftmp2$Total_LPI_hmc) / sum(dftmp2$Total) # 25.7 %
sum(dftmp2$Total_LPEI_vb) / sum(dftmp2$Total) # 25.7 %
sum(dftmp2$Total_LPEI_hmc) / sum(dftmp2$Total) # 25.7 %
personas <- dftmp2 %>% select(Alcaldia, starts_with('Porcentaje'))
personas
personas$Alcaldia
personas <- personas[match(muni, personas$Alcaldia), ]
personas
nombre <- file.path(fsep='\\', r'(C:\Maestría_CP\Tesis\Documento-Tesis-SAOM\Documento-Tesis\Figuras\c-vi\CDMX)',
'probit-ordenado-sesgado-personas.txt')
writeLines(personas %>% kable(format = 'latex', escape = F), con = nombre)
tmp <- readLines(nombre)
tmp <- tmp[-c(1:5, length(tmp)-1, length(tmp))]
tmp[length(tmp)] <- str_split_1(tmp[length(tmp)], pattern = '\\\\\\\\')[1]
writeLines(tmp, nombre)
tmp
## (4.8) Mapas ====
orden <- match(dftmp2$Alcaldia, shp$NOMGEO) # el elemento i (i=1, 2, ...) de #1 esta en la posición indicada de #2
orden2 <- match(muni, shp$NOMGEO) # el elemento i (i=1, 2, ...) de #1 esta en la posición indicada de #2
shp$LPI_vb_porcentaje[orden] <- dftmp2$Porcentaje_LPI_vb
shp$LPEI_vb_porcentaje[orden] <- dftmp2$Porcentaje_LPEI_vb
shp$LPI_hmc_porcentaje[orden] <- dftmp2$Porcentaje_LPI_hmc
shp$LPEI_hmc_porcentaje[orden] <- dftmp2$Porcentaje_LPEI_hmc
g1 <- ggplot() +
annotation_map_tile(type = carto_lightnl_url, zoomin = 0, alpha = 0.8, progress = "none") +
geom_sf(data = shp, aes(fill= LPI_vb_porcentaje)) +
geom_sf_label(data=shp, aes(label = CVE_MUN, colour=NOMGEO, family='serif'), size = 4,  key_glyph = "cust") +
scale_colour_manual(name="Alcaldías", values = pal, limits=key_label) +
annotation_scale(location = "bl", width_hint = 0.4, text_family='serif') +
annotation_north_arrow(location = "tl", which_north = "true",
pad_x = unit(0.0, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering) +
scale_fill_gradientn(colours = RColorBrewer::brewer.pal(9, "Greys")) +
scale_fill_gradient(low = "gray100", high = "gray50", limits=c(0, 50), breaks = seq(0, 50, by = 10)) +
labs(fill ='Población bajo\nLPI (%)', title = "", x='', y='') +
theme(
plot.margin = margin(0, 0, 0, 0, "cm"),
text = element_text(family = "serif", size=20),
legend.position = 'right',
panel.border = element_rect(color = "black", fill = NA, linewidth = 1))
x11(); print(g1)
g2 <- ggplot() +
annotation_map_tile(type = carto_lightnl_url, zoomin = 0, alpha = 0.8, progress = "none") +
geom_sf(data = shp, aes(fill= LPEI_vb_porcentaje)) +
geom_sf_label(data=shp, aes(label = CVE_MUN, colour=NOMGEO, family='serif'), size = 4,  key_glyph = "cust") +
scale_colour_manual(name="Alcaldías", values = pal, limits=key_label) +
annotation_scale(location = "bl", width_hint = 0.4, text_family='serif') +
annotation_north_arrow(location = "tl", which_north = "true",
pad_x = unit(0.0, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering) +
scale_fill_gradientn(colours = RColorBrewer::brewer.pal(9, "Greys")) +
scale_fill_gradient(low = "gray100", high = "gray50", limits=c(0, 50), breaks = seq(0, 50, by = 10)) +
labs(fill ='Población bajo\nLPEI (%)', title = "", x='', y='') +
theme(
plot.margin = margin(0, 0, 0, 0, "cm"),
text = element_text(family = "serif", size=20),
legend.position = 'right',
panel.border = element_rect(color = "black", fill = NA, linewidth = 1))
x11(); print(g2)
g3 <- ggplot() +
annotation_map_tile(type = carto_lightnl_url, zoomin = 0, alpha = 0.8, progress = "none") +
geom_sf(data = shp, aes(fill= LPI_hmc_porcentaje)) +
geom_sf_label(data=shp, aes(label = CVE_MUN, colour=NOMGEO, family='serif'), size = 4,  key_glyph = "cust") +
scale_colour_manual(name="Alcaldías", values = pal, limits=key_label) +
annotation_scale(location = "bl", width_hint = 0.4, text_family='serif') +
annotation_north_arrow(location = "tl", which_north = "true",
pad_x = unit(0.0, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering) +
scale_fill_gradientn(colours = RColorBrewer::brewer.pal(9, "Greys")) +
scale_fill_gradient(low = "gray100", high = "gray50", limits=c(0, 50), breaks = seq(0, 50, by = 10)) +
labs(fill ='Población bajo\nLPI (%)', title = "", x='', y='') +
theme(
plot.margin = margin(0, 0, 0, 0, "cm"),
text = element_text(family = "serif", size=20),
legend.position = 'right',
panel.border = element_rect(color = "black", fill = NA, linewidth = 1))
x11(); print(g3)
g4 <- ggplot() +
annotation_map_tile(type = carto_lightnl_url, zoomin = 0, alpha = 0.8, progress = "none") +
geom_sf(data = shp, aes(fill= LPEI_hmc_porcentaje)) +
geom_sf_label(data=shp, aes(label = CVE_MUN, colour=NOMGEO, family='serif'), size = 4,  key_glyph = "cust") +
scale_colour_manual(name="Alcaldías", values = pal, limits=key_label) +
annotation_scale(location = "bl", width_hint = 0.4, text_family='serif') +
annotation_north_arrow(location = "tl", which_north = "true",
pad_x = unit(0.0, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering) +
scale_fill_gradientn(colours = RColorBrewer::brewer.pal(9, "Greys")) +
scale_fill_gradient(low = "gray100", high = "gray50", limits=c(0, 50), breaks = seq(0, 50, by = 10)) +
labs(fill ='Población bajo\nLPEI (%)', title = "", x='', y='') +
theme(
plot.margin = margin(0, 0, 0, 0, "cm"),
text = element_text(family = "serif", size=20),
legend.position = 'right',
panel.border = element_rect(color = "black", fill = NA, linewidth = 1))
x11(); print(g4)
nombre <- file.path(fsep='\\', r'(C:\Maestría_CP\Tesis\Documento-Tesis-SAOM\Documento-Tesis\Figuras\c-vi\CDMX)',
'probit-ordenado-sesgado-')
ggsave(plot=g1, filename=paste0(nombre, 'mapavb-lpi.pdf'), width=17.53, height = 17.53, units='cm')
ggsave(plot=g2, filename=paste0(nombre, 'mapavb-lpei.pdf'), width=17.53, height = 17.53, units='cm')
ggsave(plot=g3, filename=paste0(nombre, 'mapahmc-lpi.pdf'), width=17.53, height = 17.53, units='cm')
ggsave(plot=g4, filename=paste0(nombre, 'mapahmc-lpei.pdf'), width=17.53, height = 17.53, units='cm')
library(dplyr)
library(ggplot2)
library(tidyr)
setwd(r'(C:\Maestría_CP\Tesis\Documento-Tesis-SAOM\Documento-Tesis\Figuras)')
source(r'(../Codigos/Simulacion-Modelos/funciones.R)')
dsn <- function(x0, mu=0, sigma=1, lambda=0){
y0 <- 2/sigma * dnorm((x0-mu)/sigma, 0, 1) * pnorm(lambda * (x0-mu)/sigma)
return(y0)
}
x0 <- seq(-3, 3, length=250)
y0 <- dsn(x0, lambda=0)
y1 <- dsn(x0, lambda=1)
y2 <- dsn(x0, lambda=-1)
y3 <- dsn(x0, lambda=3)
y4 <- dsn(x0, lambda=-3)
lambda <- rep(c(0, 1, -1, 3, -3), each=length(x0))
graphs1 <- tibble(x0=rep(x0, times=5), y0=c(y0, y1, y2, y3, y4), Lambda=factor(lambda))
graphs1$Lambda <- factor(graphs1$Lambda, levels = c("0", "1", "3", '-1', '-3'))
g1 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif")) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g1)
g1 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=20)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g1)
g2 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif")) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g2)
g2 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=20)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g2)
# (3) Figura 3.x log-normal sesgada ====
dlogsn <- function(x0, mu=0, sigma=1, lambda=0){
y0 <- 2/(x0*sigma) * dnorm((log(x0)-mu)/sigma) * pnorm(lambda * (log(x0)-mu)/sigma)
return(y0)
}
x0 <- seq(0.001, 6, length=200)
dftmp <- tibble(x0=x0, y0=dlogsn(x0, lambda=0), y1=dlogsn(x0, lambda=1), y2=dlogsn(x0, lambda=3),
y3=dlogsn(x0, lambda=-1), y4=dlogsn(x0, lambda=-3))
graphs2 <- dftmp %>%
pivot_longer(
cols = starts_with("y"),
names_to = "Lambda",
values_to = "y"          # the density values
) %>%
mutate(
Lambda = recode(Lambda, y0 = 0, y1 = 1, y2 = 3, y3 = -1, y4 = -3),
Lambda = factor(Lambda, labels = c(0, -1, 1, -3, 3))
)
g3 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif")) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g3)
g3 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=20)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g3)
g4 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif")) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
g4 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=20)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g4)
ggsave(plot=g1, filename='./c-ii/SN_density_pos.pdf', width=20, height = 20, units='cm')
ggsave(plot=g2, filename='./c-ii/SN_density_neg.pdf', width=20, height = 20, units='cm')
ggsave(plot=g3, filename='./c-ii/logSN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g4, filename='./c-ii/logSN_density_neg.png', width=20, height = 20, units='cm')
setwd(r'(C:\Maestria\Articulo-GitHub\Figuras)')
ggsave(plot=g3, filename='./logSN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g4, filename='./logSN_density_neg.png', width=20, height = 20, units='cm')
ggsave(plot=g1, filename='./SN_density_pos.pdf', width=20, height = 20, units='cm')
ggsave(plot=g2, filename='./SN_density_neg.pdf', width=20, height = 20, units='cm')
ggsave(plot=g1, filename='./SN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g2, filename='./SN_density_neg.png', width=20, height = 20, units='cm')
g1 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top',
text = element_text(family = "serif", size = 24)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g1)
g2 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top',
text = element_text(family = "serif", size=24)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g2)
g3 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=24)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g3)
g4 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=24)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
x11(); plot(g4)
# (4) Guardar gráficas ====
getwd()
# (4) Guardar gráficas ====
getwd()
ggsave(plot=g1, filename='./SN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g2, filename='./SN_density_neg.png', width=20, height = 20, units='cm')
ggsave(plot=g3, filename='./logSN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g4, filename='./logSN_density_neg.png', width=20, height = 20, units='cm')
g1 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top',
text = element_text(family = "serif", size = 26)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
g2 <- ggplot(data=graphs1 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y0, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top',
text = element_text(family = "serif", size=26)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
g3 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(3, 1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
# scale_color_manual(values = setNames(gray.colors(n=3, end=0.5), c(0, 1, 3)), name = "Lambda") +
# scale_linetype_manual(values = setNames(1:3,  c(0, 1, 3)), name = "Lambda") +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=26)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
g4 <- ggplot(data=graphs2 %>% filter(Lambda%in%c(-3, -1, 0)),
aes(x=x0, y=y, color=Lambda, linetype = Lambda)) +
geom_line(linewidth=1.2) +
scale_color_manual(values=gray.colors(n=3, end=0.5)) +
scale_linetype_manual(values=1:3) +
geom_hline(yintercept = 0)+
theme_minimal() +
theme(legend.position = 'top', text = element_text(family = "serif", size=26)) +
labs(x=expression(x), y = '' , color = bquote(Valor~de~lambda~':')) +
guides(
color = guide_legend(override.aes = list(linetype = 1:3, size = 1.2)),
linetype = "none"
)
# (4) Guardar gráficas ====
getwd()
ggsave(plot=g1, filename='./SN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g2, filename='./SN_density_neg.png', width=20, height = 20, units='cm')
ggsave(plot=g3, filename='./logSN_density_pos.png', width=20, height = 20, units='cm')
ggsave(plot=g4, filename='./logSN_density_neg.png', width=20, height = 20, units='cm')
